<!DOCTYPE html >
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <title>OEEM Dashboard</title>
    <script id="sap-ui-bootstrap"
            src="/sapui5/resources/sap-ui-core.js"
            data-sap-ui-theme="sap_goldreflection"
            data-sap-ui-libs="sap.ui.core,sap.ui.commons,sap.ui.table,sap.ui.ux3"
            data-sap-ui-language="en">
    </script>
    <script type="text/javascript" src="Common/js/default.js"></script>
    <script src="Common/js/highcharts/highstock.js"></script>
    <script src="Common/js/highcharts/highcharts-3d.js"></script>
    <link href="Common/font-awesome-4.7.0/css/font-awesome.css" rel="stylesheet">
    <link href="Common/bootstrap/bootstrap.min.css" rel="stylesheet">
    <script src="Common/bootstrap/bootstrap.min.js"></script>
    <link href="Common/css/oeeDashboard.css" rel="stylesheet">
    <script src="Common/js/oeeDashboard.js"></script>
    <style>
        body {
            background-image: url("Common/img/logo.png");
            background-size: 180px;
            background-repeat: no-repeat;
            background-attachment: fixed;
            background-position: right 40px top 30px;
            font-family: Arial;
            background-color: white;
        }

        #app_header {
            padding: 10px;
            padding-left: 40px;
            padding-top: 15px;
            padding-bottom: 0px;
            height: 80px;
            width: 400px;
            text-align: center;
        }

        #app_title {
            width: 400px;
            text-align: center;
            font-family: "Arial Black", Arial, Helvetica, sans-serif;
            font-size: 32px;
            color: #007dc0;
            margin-bottom;
            20px;
        }

        #app_menu {
            width: 400px;
            text-align: center;
            font-family: Arial, Helvetica, sans-serif;
        }

        #page_title {
            width: 400px;
            text-align: center;
            font-family: "Arial Black", Arial, Helvetica, sans-serif;
            font-size: 28px;
            color: #cfcfcf;
        }

        #mesm_content {
            padding: 5px;
            padding-top: 40px;
        }

        #__button0, #__button1, #__button2 {
            margin-top: 10px;
            margin-left: 5px;
            margin-right: 5px;
        }

        #MatrixT {
            margin: 20px auto;
            margin-bottom: 0px;
        }

        #__cell0 {
            text-align: right;
            margin-left: 20px;
        }
    </style>

    <script type="text/javascript" id="app-init">
        // ******************************************************************************************************************************************************************
        // Get Core SAP UI5
        var oCore = sap.ui.getCore();
        // ******************************************************************************************************************************************************************
        // initialize access
        var level2Access = "";
        var plant2Access = "";
        // Initialize screen
        var selectedOps = "";
        // ******************************************************************************************************************************************************************
        var TICK = 0;
        var rtsOEEM = {
            availability: 85,
            performance: 85,
            quality: 85,
            productCurrent: 0,
            productTarget: 5555,
            downtime: false,
            downtimeCurrent: 0,
            downtimeTotal: 0,
            bigLossFilter: 90,
            sblEquipmentFailure: {
                title: 'Equipment Failure',
                occurrences: 0,
                totalizer: 0,
                rate: [0, 0, 0, 0, 0, 0, 0, 0, 0]
            },
            sblSetupAndAdjustments: {
                title: 'Setup and Adjustments',
                occurrences: 0,
                totalizer: 0,
                rate: [0, 0, 0, 0, 0, 0, 0, 0, 0]
            },
            sblIdlingAndMinorStops: {
                title: 'Idling and Minor Stops',
                occurrences: 0,
                totalizer: 0,
                rate: [0, 0, 0, 0, 0, 0, 0, 0, 0]
            },
            sblReducedSpeed: {
                title: 'Reduced Speed',
                occurrences: 0,
                totalizer: 0,
                rate: [0, 0, 0, 0, 0, 0, 0, 0, 0]
            },
            sblProcessDefects: {
                title: 'Process Defects',
                occurrences: 0,
                totalizer: 0,
                rate: [0, 0, 0, 0, 0, 0, 0, 0, 0]
            },
            sblReducedYield: {
                title: 'Reduced Yield',
                occurrences: 0,
                totalizer: 0,
                rate: [0, 0, 0, 0, 0, 0, 0, 0, 0]
            },
            events: [
                {reason: '', occurrences: 0, totalizer: 0},
            ]
        };

        // ******************************************************************************************************************************************************************

        function roleSecurity() {
            var myRoles = document.getElementById("user_roles").value;
            var role2Access = "MESM_" + document.getElementById("user_role").value;
            // alert(role2Access);
            if (myRoles.indexOf(role2Access) < 0) {
                window.location.assign("security.irpt");
            } else {
                var roleString = document.getElementById("user_role").value;
                var roleArray = roleString.split("_");
                level2Access = roleArray[0];
                // alert("level : " + level2Access);
                plant2Access = roleArray[1];
                // alert("plant : " + plant2Access);
                updateDates();
                selectedOps = document.getElementById("station_name").value;
                cc(document.getElementById("station_name").value);
                //createTableConnDiagnostics();
                document.getElementById("page_title").innerHTML = role2Access;

                // enable homepage
                oCore.byId("item3-0-3").setEnabled(true);
                // show menus
                oMenuButton1.placeAt("app_menu");
                oMenuButton2.placeAt("app_menu");
                oMenuButton3.placeAt("app_menu");

                var role_ADM = "MESM_ADM_" + plant2Access;
                var role_ENG = "MESM_ENG_" + plant2Access;
                var role_SUP = "MESM_SUP_" + plant2Access;
                var role_OPS = "MESM_OPS_" + plant2Access;

                switch (role2Access) {
                    case "MESM_ADM_ALL":

                        // enable Cfg Hierarchy
                        oCore.byId("item1-0-1").setEnabled(true);
                        // enable Cfg Memory Maps
                        oCore.byId("item1-0-3").setEnabled(true);
                        // enable Cfg Connectivity
                        oCore.byId("item1-0-4").setEnabled(true);
                        // enable Master Data
                        oCore.byId("item1-0-5").setEnabled(true);

                        // SPC
                        // enable SPC home page
                        oCore.byId("item1-0-6").setEnabled(true);
                        // enable Plants submenu
                        oCore.byId("item1-0-7").setEnabled(true);
                        // enable  Stations submenu
                        oCore.byId("item1-0-8").setEnabled(true);
                        // enable Part submenu
                        oCore.byId("item1-0-9").setEnabled(true);
                        // enable Datapoints submenu
                        oCore.byId("item1-0-10").setEnabled(true);
                        // enable Operators submenu
                        oCore.byId("item1-0-11").setEnabled(true);
                        // enable Subscriptions submenu
                        oCore.byId("item1-0-12").setEnabled(true);

                        // enable WO Management
                        oCore.byId("item2-0-1").setEnabled(true);
                        // enable Carrier Station Dashboard
                        oCore.byId("item2-0-2").setEnabled(true);
                        // enable Assembly Station Dashboard
                        oCore.byId("item2-0-3").setEnabled(true);

                        // SPC
                        // enable SPC Dashboard
                        oCore.byId("item2-0-4").setEnabled(true);
                        // enable Saved File Charts
                        //	oCore.byId("item2-0-5").setEnabled(true);
                        // enable  PC History Logs
                        //	oCore.byId("item2-0-6").setEnabled(true);

                        // enable Production Status Shifts Report
                        oCore.byId("item3-0-1").setEnabled(true);
                        // enable Item Traceability Report
                        oCore.byId("item3-0-2").setEnabled(true);
                        // enable Connector Diagnostics
                        oCore.byId("item3-0-3").setEnabled(true);

                        // SPC
                        // enable Daily Activity
                        oCore.byId("item3-0-4").setEnabled(true);
                        // enable Weekly Activity
                        oCore.byId("item3-0-5").setEnabled(true);
                        // enable onthly Activity
                        oCore.byId("item3-0-6").setEnabled(true);

                        // enable Equipment Hierarchy
                        oCore.byId("item1-4-1").setEnabled(true);
                        // enable Cfg Hierarchy Levels
                        oCore.byId("item1-4-2").setEnabled(true);

                        // enable Cfg Memory Maps
                        oCore.byId("item1-5-1").setEnabled(true);
                        // enable Cfg Tag Types
                        oCore.byId("item1-5-2").setEnabled(true);
                        // enable Cfg Tag Functions
                        oCore.byId("item1-5-3").setEnabled(true);
                        // enable Cfg Tag Groups
                        oCore.byId("item1-5-4").setEnabled(true);
                        // enable Cfg Memory Map Transactions
                        oCore.byId("item1-5-5").setEnabled(true);

                        // enable Cfg Shop Floor Computers
                        oCore.byId("item1-6-1").setEnabled(true);
                        // enable Cfg Shop Floor Printers
                        oCore.byId("item1-6-2").setEnabled(true);
                        // enable Cfg PCo Servers
                        oCore.byId("item1-6-3").setEnabled(true);
                        // enable Cfg PCo Agents
                        oCore.byId("item1-6-4").setEnabled(true);
                        // enable Cfg Sql Servers
                        oCore.byId("item1-6-5").setEnabled(true);
                        // enable Cfg Operators
                        oCore.byId("item1-6-6").setEnabled(true);
                        // enable Cfg File Servers
                        oCore.byId("item1-6-7").setEnabled(true);
                        // enable Cfg File Agents
                        oCore.byId("item1-6-8").setEnabled(true);

                        // Enable UOM Maintenance
                        oCore.byId("item1-7-1").setEnabled(true);
                        // Enable Product Maintenance
                        oCore.byId("item1-7-2").setEnabled(true);
                        // Enable BOM Maintenance
                        oCore.byId("item1-7-3").setEnabled(true);
                        // Enable Routing Maintenance
                        oCore.byId("item1-7-4").setEnabled(true);

                        // SPC
                        // enable Plants  Maintenance
                        oCore.byId("item1-8-1").setEnabled(true);
                        // enable Import Plants
                        oCore.byId("item1-8-2").setEnabled(true);
                        // enable Export Plants
                        oCore.byId("item1-8-3").setEnabled(true);

                        // enable Stations   Maintenance
                        oCore.byId("item1-9-1").setEnabled(true);
                        // enable Import Stations
                        oCore.byId("item1-9-2").setEnabled(true);
                        // enable Export Stations
                        oCore.byId("item1-9-3").setEnabled(true);

                        // enable Parts Maintenance
                        oCore.byId("item1-10-1").setEnabled(true);
                        // enable Import Parts
                        oCore.byId("item1-10-2").setEnabled(true);
                        // enable Export Parts
                        oCore.byId("item1-10-3").setEnabled(true);

                        // enable Datapoints HDR
                        oCore.byId("item1-11-1").setEnabled(true);
                        // enable Datapoints SPC
                        oCore.byId("item1-11-2").setEnabled(true);
                        // enable Import Datapoints
                        oCore.byId("item1-11-3").setEnabled(true);
                        // enable Export Datapoints
                        oCore.byId("item1-11-4").setEnabled(true);

                        // enable Operatord Maintenance
                        oCore.byId("item1-12-1").setEnabled(true);
                        // enable Import Operators
                        oCore.byId("item1-12-2").setEnabled(true);
                        // enable  Export Operators
                        oCore.byId("item1-12-3").setEnabled(true);

                        // enable Subscriptions Maintenance
                        oCore.byId("item1-13-1").setEnabled(true);
                        // enable Import Subscriptions
                        oCore.byId("item1-13-2").setEnabled(true);
                        // enable Export Subscriptions
                        oCore.byId("item1-13-3").setEnabled(true);

                        // update screen
                        document.getElementById("page_title").innerHTML = selectedOps;
                        oMatrixT.placeAt('mesm_content');
                        break;
                    case role_ADM:
                        // enable Cfg Hierarchy
                        oCore.byId("item1-0-1").setEnabled(true);
                        // enable Cfg Memory Maps
                        oCore.byId("item1-0-3").setEnabled(true);
                        // enable Cfg Connectivity
                        oCore.byId("item1-0-4").setEnabled(true);
                        // enable Master Data
                        oCore.byId("item1-0-5").setEnabled(true);

                        // SPC
                        // enable SPC home page
                        oCore.byId("item1-0-6").setEnabled(true);
                        // enable Plants submenu
                        oCore.byId("item1-0-7").setEnabled(true);
                        // enable  Stations submenu
                        oCore.byId("item1-0-8").setEnabled(true);
                        // enable Part submenu
                        oCore.byId("item1-0-9").setEnabled(true);
                        // enable   Datapoints submenu
                        oCore.byId("item1-0-10").setEnabled(true);
                        // enable Operators submenu
                        oCore.byId("item1-0-11").setEnabled(true);
                        // enable Subscriptions submenu
                        oCore.byId("item1-0-12").setEnabled(true);

                        // enable WO Management
                        oCore.byId("item2-0-1").setEnabled(true);
                        // enable Carrier Station Dashboard
                        oCore.byId("item2-0-2").setEnabled(true);
                        // enable Assembly Station Dashboard
                        oCore.byId("item2-0-3").setEnabled(true);

                        // SPC
                        // enable SPC Dashboard
                        oCore.byId("item2-0-4").setEnabled(true);
                        // enable Saved File Charts
                        //	oCore.byId("item2-0-5").setEnabled(true);
                        // enable  PC History Logs
                        //	oCore.byId("item2-0-6").setEnabled(true);

                        // enable Production Status Report
                        oCore.byId("item3-0-1").setEnabled(true);
                        // enable Item Traceability Report
                        oCore.byId("item3-0-2").setEnabled(true);
                        // enable Connector Diagnostics
                        oCore.byId("item3-0-3").setEnabled(true);

                        // SPC
                        // enable Daily Activity
                        oCore.byId("item3-0-4").setEnabled(true);
                        // enable Weekly Activity
                        oCore.byId("item3-0-5").setEnabled(true);
                        // enable onthly Activity
                        oCore.byId("item3-0-6").setEnabled(true);

                        // enable Equipment Hierarchy
                        oCore.byId("item1-4-1").setEnabled(true);
                        // enable Cfg Hierarchy Levels
                        oCore.byId("item1-4-2").setEnabled(true);

                        // enable Cfg Memory Maps
                        oCore.byId("item1-5-1").setEnabled(true);
                        // enable Cfg Tag Types
                        oCore.byId("item1-5-2").setEnabled(true);
                        // enable Cfg Tag Functions
                        oCore.byId("item1-5-3").setEnabled(true);
                        // enable Cfg Tag Groups
                        oCore.byId("item1-5-4").setEnabled(true);
                        // enable Cfg Memory Map Transactions
                        oCore.byId("item1-5-5").setEnabled(true);

                        // enable Cfg Shop Floor Computers
                        oCore.byId("item1-6-1").setEnabled(true);
                        // enable Cfg Shop Floor Printers
                        oCore.byId("item1-6-2").setEnabled(true);
                        // enable Cfg PCo Servers
                        oCore.byId("item1-6-3").setEnabled(true);
                        // enable Cfg PCo Agents
                        oCore.byId("item1-6-4").setEnabled(true);
                        // enable Cfg Sql Servers
                        oCore.byId("item1-6-5").setEnabled(true);
                        // enable Cfg Operators
                        oCore.byId("item1-6-6").setEnabled(true);
                        // enable Cfg File Servers
                        oCore.byId("item1-6-7").setEnabled(true);
                        // enable Cfg File Agents
                        oCore.byId("item1-6-8").setEnabled(true);

                        // Enable UOM Maintenance
                        oCore.byId("item1-7-1").setEnabled(true);
                        // Enable Product Maintenance
                        oCore.byId("item1-7-2").setEnabled(true);
                        // Enable BOM Maintenance
                        oCore.byId("item1-7-3").setEnabled(true);
                        // Enable Routing Maintenance
                        oCore.byId("item1-7-4").setEnabled(true);

                        // SPC
                        // enable Plants  Maintenance
                        oCore.byId("item1-8-1").setEnabled(true);
                        // enable Import Plants
                        oCore.byId("item1-8-2").setEnabled(true);
                        // enable Export Plants
                        oCore.byId("item1-8-3").setEnabled(true);

                        // enable Stations   Maintenance
                        oCore.byId("item1-9-1").setEnabled(true);
                        // enable Import Stations
                        oCore.byId("item1-9-2").setEnabled(true);
                        // enable Export Stations
                        oCore.byId("item1-9-3").setEnabled(true);

                        // enable Parts Maintenance
                        oCore.byId("item1-10-1").setEnabled(true);
                        // enable Import Parts
                        oCore.byId("item1-10-2").setEnabled(true);
                        // enable Export Parts
                        oCore.byId("item1-10-3").setEnabled(true);

                        // enable Datapoints HDR
                        oCore.byId("item1-11-1").setEnabled(true);
                        // enable Datapoints SPC
                        oCore.byId("item1-11-2").setEnabled(true);
                        // enable Import Datapoints
                        oCore.byId("item1-11-3").setEnabled(true);
                        // enable Export Datapoints
                        oCore.byId("item1-11-4").setEnabled(true);

                        // enable Operatord Maintenance
                        oCore.byId("item1-12-1").setEnabled(true);
                        // enable Import Operators
                        oCore.byId("item1-12-2").setEnabled(true);
                        // enable  Export Operators
                        oCore.byId("item1-12-3").setEnabled(true);

                        // enable Subscriptions Maintenance
                        oCore.byId("item1-13-1").setEnabled(true);
                        // enable Import Subscriptions
                        oCore.byId("item1-13-2").setEnabled(true);
                        // enable Export Subscriptions
                        oCore.byId("item1-13-3").setEnabled(true);

                        // update screen
                        document.getElementById("page_title").innerHTML = selectedOps;
                        oMatrixT.placeAt('mesm_content');
                        break;
                    case "MESM_OPS_ALL":
                        // enable WO Management
                        oCore.byId("item2-0-1").setEnabled(true);
                        // enable Carrier Station Dashboard
                        oCore.byId("item2-0-2").setEnabled(true);
                        // enable Assembly Station Dashboard
                        oCore.byId("item2-0-3").setEnabled(true);

                        // SPC
                        // enable SPC Dashboard
                        oCore.byId("item2-0-4").setEnabled(true);
                        // enable Saved File Charts
                        //	oCore.byId("item2-0-5").setEnabled(true);
                        // enable  PC History Logs
                        //	oCore.byId("item2-0-6").setEnabled(true);

                        // enable Production Status Report
                        oCore.byId("item3-0-1").setEnabled(true);
                        // enable Item Traceability Report
                        oCore.byId("item3-0-2").setEnabled(true);
                        // enable Connector Diagnostics
                        oCore.byId("item3-0-3").setEnabled(true);

                        // SPC
                        // enable Daily Activity
                        oCore.byId("item3-0-4").setEnabled(true);
                        // enable Weekly Activity
                        oCore.byId("item3-0-5").setEnabled(true);
                        // enable onthly Activity
                        oCore.byId("item3-0-6").setEnabled(true);

                        document.getElementById("page_title").innerHTML = selectedOps;
                        oMatrixT.placeAt('mesm_content');
                        break;
                    case role_OPS:
                        // enable WO Management
                        oCore.byId("item2-0-1").setEnabled(true);
                        // enable Carrier Station Dashboard
                        oCore.byId("item2-0-2").setEnabled(true);
                        // enable Assembly Station Dashboard
                        oCore.byId("item2-0-3").setEnabled(true);

                        // SPC
                        // enable SPC Dashboard
                        oCore.byId("item2-0-4").setEnabled(true);
                        // enable Saved File Charts
                        //	oCore.byId("item2-0-5").setEnabled(true);
                        // enable  PC History Logs
                        //	oCore.byId("item2-0-6").setEnabled(true);

                        // enable Production Status Report
                        oCore.byId("item3-0-1").setEnabled(true);
                        // enable Item Traceability Report
                        oCore.byId("item3-0-2").setEnabled(true);
                        // enable Connector Diagnostics
                        oCore.byId("item3-0-3").setEnabled(true);

                        // SPC
                        // enable Daily Activity
                        oCore.byId("item3-0-4").setEnabled(true);
                        // enable Weekly Activity
                        oCore.byId("item3-0-5").setEnabled(true);
                        // enable onthly Activity
                        oCore.byId("item3-0-6").setEnabled(true);

                        document.getElementById("page_title").innerHTML = selectedOps;
                        oMatrixT.placeAt('mesm_content');
                        break;
                    default:
                        alert("MES Module Role Unknown: " + role2Access);
                        break;
                }
            }
            //todo: init
            chartOeeTrendInit("Oee Trend", null);             //title & series, random data if null
            chartSixBigLossesInit("Six Big Losses", null);    //title & series, random data if null
            chartEventsInit("Downtime Events", null);         //title & series, random data if null
            sblChartsInit();
        }

        // ******************************************************************************************************************************************************************


        var spc_href = location.href.substring(0, location.href.indexOf('MESM')) + "SPCMC/";

        var oMenuButton1 = new sap.ui.commons.MenuButton({text: "Settings", icon: "Common/img/map.png"});
        var oMenuButton2 = new sap.ui.commons.MenuButton({text: "Dashboards", icon: "Common/img/cloud.png"});
        var oMenuButton3 = new sap.ui.commons.MenuButton({text: "Reports", icon: "Common/img/list.png"});

        // Create the button menus
        var oMenu1 = new sap.ui.commons.Menu("menu1", {ariaDescription: "Application Setup", enabled: true});
        var oMenu2 = new sap.ui.commons.Menu("menu2", {ariaDescription: "User Dashboards", enabled: true});
        var oMenu3 = new sap.ui.commons.Menu("menu3", {ariaDescription: "User Reports", enabled: true});

        // Create the items and add them to the menu 1------------------	Application Setup		-------------------------------------

        var oMenuItem1 = new sap.ui.commons.MenuItem("item1-0-1", {text: "Enterprise Hierarchy", enabled: false});
        oMenu1.addItem(oMenuItem1);
        var oMenuItem2 = new sap.ui.commons.MenuItem("item1-0-2", {text: " ???", enabled: false});
        //oMenu1.addItem(oMenuItem2);
        var oMenuItem3 = new sap.ui.commons.MenuItem("item1-0-3", {text: "MES Memory Maps", enabled: false});
        oMenu1.addItem(oMenuItem3);
        var oMenuItem4 = new sap.ui.commons.MenuItem("item1-0-4", {text: "Plant Connectivity", enabled: false});
        oMenu1.addItem(oMenuItem4);
        var oMenuItem5 = new sap.ui.commons.MenuItem("item1-0-5", {text: "Master Data Setup", enabled: false});
        oMenu1.addItem(oMenuItem5);
        //----------------------SPC---------------------------------------

        oMenu1.setAriaDescription("SPC");

        var oMenuItem6 = new sap.ui.commons.MenuItem("item1-0-6", {text: "SPCM Home", enabled: false});
        //oMenu1.addItem(oMenuItem6);

        var oMenuItem7 = new sap.ui.commons.MenuItem("item1-0-7", {text: "Plant Setup"});
        //oMenu1.addItem(oMenuItem7);
        var oMenuItem8 = new sap.ui.commons.MenuItem("item1-0-8", {text: "Station Setup"});
        //oMenu1.addItem(oMenuItem8);
        var oMenuItem9 = new sap.ui.commons.MenuItem("item1-0-9", {text: "Parts Setup"});
        //oMenu1.addItem(oMenuItem9);
        var oMenuItem10 = new sap.ui.commons.MenuItem("item1-0-10", {text: "Charts Setup"});
        //oMenu1.addItem(oMenuItem10);
        var oMenuItem11 = new sap.ui.commons.MenuItem("item1-0-11", {text: "Operator Setup"});
        //oMenu1.addItem(oMenuItem11);
        var oMenuItem12 = new sap.ui.commons.MenuItem("item1-0-12", {text: "Subscriptions Setup"});
        //oMenu1.addItem(oMenuItem12);

        //-------------------------------------------------------------------------

        // Create submenu 4 	----------------	Hierarchy Setup			------------------------------

        var oMenu4 = new sap.ui.commons.Menu("menu4", {ariaDescription: "Hierarchy Setup", enabled: true});

        //Create the items and add them to the sub menu
        var oMenuItem41 = new sap.ui.commons.MenuItem("item1-4-1", {text: "Hierarchy Management", enabled: false});
        oMenu4.addItem(oMenuItem41);
        var oMenuItem42 = new sap.ui.commons.MenuItem("item1-4-2", {text: "Hierarchy Levels Setup", enabled: false});
        oMenu4.addItem(oMenuItem42);

        oMenuItem1.setSubmenu(oMenu4);

        // Create  submenu  5  	--------------	Memory Maps Setup		--------------------------

        var oMenu5 = new sap.ui.commons.Menu("menu5", {ariaDescription: "Memory Maps Setup", enabled: true});

        //Create the items and add them to the sub menu
        var oMenuItem51 = new sap.ui.commons.MenuItem("item1-5-1", {text: "Memory Map Tags", enabled: false});
        oMenu5.addItem(oMenuItem51);
        var oMenuItem52 = new sap.ui.commons.MenuItem("item1-5-2", {text: "Memory Map Transactions", enabled: false});
        oMenu5.addItem(oMenuItem52);
        var oMenuItem53 = new sap.ui.commons.MenuItem("item1-5-3", {text: "PLC Tag Groups", enabled: false});
        oMenu5.addItem(oMenuItem53);
        var oMenuItem54 = new sap.ui.commons.MenuItem("item1-5-4", {text: "PLC Tag Types", enabled: false});
        oMenu5.addItem(oMenuItem54);
        var oMenuItem55 = new sap.ui.commons.MenuItem("item1-5-5", {text: "PLC Tag Functions", enabled: false});
        oMenu5.addItem(oMenuItem55);

        oMenuItem3.setSubmenu(oMenu5);

        // Create submenu  6  	--------------	Connectivity Setup	-------------------------

        var oMenu6 = new sap.ui.commons.Menu("menu6", {ariaDescription: "Connectivity Setup", enabled: true});

        //Create the items and add them to the sub menu
        var oMenuItem61 = new sap.ui.commons.MenuItem("item1-6-1", {text: "Shop Floor Operators", enabled: false});
        oMenu6.addItem(oMenuItem61);
        var oMenuItem62 = new sap.ui.commons.MenuItem("item1-6-2", {text: "Shop Floor Computers", enabled: false});
        oMenu6.addItem(oMenuItem62);
        var oMenuItem63 = new sap.ui.commons.MenuItem("item1-6-3", {text: "Shop Floor Printers", enabled: false});
        oMenu6.addItem(oMenuItem63);
        var oMenuItem64 = new sap.ui.commons.MenuItem("item1-6-4", {
            text: "Plant Connectivity Servers",
            enabled: false
        });
        oMenu6.addItem(oMenuItem64);
        var oMenuItem65 = new sap.ui.commons.MenuItem("item1-6-5", {text: "Plant Connectivity Agents", enabled: false});
        oMenu6.addItem(oMenuItem65);
        var oMenuItem66 = new sap.ui.commons.MenuItem("item1-6-6", {text: "Line Side SQL Servers", enabled: false});
        oMenu6.addItem(oMenuItem66);
        var oMenuItem67 = new sap.ui.commons.MenuItem("item1-6-7", {text: "File Connectivity Servers", enabled: false});
        oMenu6.addItem(oMenuItem67);
        var oMenuItem68 = new sap.ui.commons.MenuItem("item1-6-8", {text: "File Connectivity Agents", enabled: false});
        oMenu6.addItem(oMenuItem68);

        oMenuItem4.setSubmenu(oMenu6);

        // Create  submenu  7  	--------------	Master Data		------------------------

        var oMenu7 = new sap.ui.commons.Menu("menu7", {ariaDescription: "Master Data", enabled: true});

        //Create the items and add them to the sub menu
        var oMenuItem71 = new sap.ui.commons.MenuItem("item1-7-1", {text: "Units Of Measure", enabled: false});
        oMenu7.addItem(oMenuItem71);
        var oMenuItem72 = new sap.ui.commons.MenuItem("item1-7-2", {text: "Products Management", enabled: false});
        oMenu7.addItem(oMenuItem72);
        var oMenuItem73 = new sap.ui.commons.MenuItem("item1-7-3", {text: "Bills of Materials", enabled: false});
        oMenu7.addItem(oMenuItem73);
        var oMenuItem74 = new sap.ui.commons.MenuItem("item1-7-4", {text: "Products Routing", enabled: false});
        oMenu7.addItem(oMenuItem74);

        oMenuItem5.setSubmenu(oMenu7);

        // Create  submenu  8  (SPC)	--------------	Plant Data		------------------------

        var oMenu8 = new sap.ui.commons.Menu("menu8", {ariaDescription: "Plant Data"});

        //Create the items and add them to the sub menu
        var oMenuItem81 = new sap.ui.commons.MenuItem("item1-8-1", {
            text: "Setup Plants",
            tooltip: "Plant  Definition",
            enabled: false
        });
        oMenu8.addItem(oMenuItem81);
        var oMenuItem82 = new sap.ui.commons.MenuItem("item1-8-2", {
            text: "Import Plants",
            tooltip: "Plants Import",
            enabled: false
        });
        oMenu8.addItem(oMenuItem82);
        var oMenuItem83 = new sap.ui.commons.MenuItem("item1-8-3", {
            text: "Export Plants",
            tooltip: "Plants Export",
            enabled: false
        });
        oMenu8.addItem(oMenuItem83);

        oMenuItem7.setSubmenu(oMenu8);

        // Create  submenu  9  (SPC)	--------------	Station Data		-----------------------

        var oMenu9 = new sap.ui.commons.Menu("menu9", {ariaDescription: "Station Data"});

        //Create the items and add them to the sub menu
        var oMenuItem91 = new sap.ui.commons.MenuItem("item1-9-1", {
            text: "Setup Stations",
            tooltip: "Shop-Floor Station Definition",
            enabled: false
        });
        oMenu9.addItem(oMenuItem91);
        var oMenuItem92 = new sap.ui.commons.MenuItem("item1-9-2", {
            text: "Import Stations",
            tooltip: "Shop-Floor Station Import",
            enabled: false
        });
        oMenu9.addItem(oMenuItem92);
        var oMenuItem93 = new sap.ui.commons.MenuItem("item1-9-3", {
            text: "Export Stations",
            tooltip: "Shop-Floor Station Export",
            enabled: false
        });
        oMenu9.addItem(oMenuItem93);

        oMenuItem8.setSubmenu(oMenu9);

        // Create  submenu  10  (SPC)	--------------	Parts Data		-----------------------

        var oMenu10 = new sap.ui.commons.Menu("menu10", {ariaDescription: "Parts Data"});

        //Create the items and add them to the sub menu
        var oMenuItem101 = new sap.ui.commons.MenuItem("item1-10-1", {
            text: "Setup Parts",
            tooltip: "Shop-Floor Parts Definition",
            enabled: false
        });
        oMenu10.addItem(oMenuItem101);
        var oMenuItem102 = new sap.ui.commons.MenuItem("item1-10-2", {
            text: "Import Parts",
            tooltip: "Shop-Floor Parts Import",
            enabled: false
        });
        oMenu10.addItem(oMenuItem102);
        var oMenuItem103 = new sap.ui.commons.MenuItem("item1-10-3", {
            text: "Export Parts",
            tooltip: "Shop-Floor Parts Export",
            enabled: false
        });
        oMenu10.addItem(oMenuItem103);

        oMenuItem9.setSubmenu(oMenu10);

        // Create  submenu  11  (SPC)	--------------	Charts		----------------------

        var oMenu11 = new sap.ui.commons.Menu("menu11", {ariaDescription: "Charts"});

        //Create the items and add them to the sub menu
        var oMenuItem111 = new sap.ui.commons.MenuItem("item1-11-1", {
            text: "Chart Hierarchy",
            tooltip: "Chart Hierarchy Definition",
            enabled: false
        });
        oMenu11.addItem(oMenuItem111);
        var oMenuItem112 = new sap.ui.commons.MenuItem("item1-11-2", {
            text: "Chart SPC Parameters",
            tooltip: "Chart SPC Parameters",
            enabled: false
        });
        oMenu11.addItem(oMenuItem112);
        var oMenuItem113 = new sap.ui.commons.MenuItem("item1-11-3", {
            text: "Import Chart Data",
            tooltip: "Chart Data Import",
            enabled: false
        });
        oMenu11.addItem(oMenuItem113);
        var oMenuItem114 = new sap.ui.commons.MenuItem("item1-11-4", {
            text: "Export Chart Data",
            tooltip: "Chart Data Export",
            enabled: false
        });
        oMenu11.addItem(oMenuItem114);

        oMenuItem10.setSubmenu(oMenu11);

        // Create  submenu  12  (SPC)	--------------	Operator Data		---------------------

        var oMenu12 = new sap.ui.commons.Menu("menu12", {ariaDescription: "Operator Data"});

        //Create the items and add them to the sub menu
        var oMenuItem121 = new sap.ui.commons.MenuItem("item1-12-1", {
            text: "Setup Operators",
            tooltip: "Shop-Floor Operator Definition",
            enabled: false
        });
        oMenu12.addItem(oMenuItem121);
        var oMenuItem122 = new sap.ui.commons.MenuItem("item1-12-2", {
            text: "Import Operators",
            tooltip: "Shop-Floor Operator Import",
            enabled: false
        });
        oMenu12.addItem(oMenuItem122);
        var oMenuItem123 = new sap.ui.commons.MenuItem("item1-12-3", {
            text: "Export Operators",
            tooltip: "Shop-Floor Operator Export",
            enabled: false
        });
        oMenu12.addItem(oMenuItem123);

        oMenuItem11.setSubmenu(oMenu12);

        // Create  submenu  13  (SPC)	--------------	Subscriptions Data		--------------------

        var oMenu13 = new sap.ui.commons.Menu("menu13", {ariaDescription: "Subscriptions Data"});

        //Create the items and add them to the sub menu
        var oMenuItem131 = new sap.ui.commons.MenuItem("item1-13-1", {
            text: "Setup Subscriptions",
            tooltip: "Alert Subscription Definition",
            enabled: false
        });
        oMenu13.addItem(oMenuItem131);
        var oMenuItem132 = new sap.ui.commons.MenuItem("item1-13-2", {
            text: "Import Subscriptions",
            tooltip: "Subscription Import",
            enabled: false
        });
        oMenu13.addItem(oMenuItem132);
        var oMenuItem133 = new sap.ui.commons.MenuItem("item1-13-3", {
            text: "Export Subscriptions",
            tooltip: "Subscription Export",
            enabled: false
        });
        oMenu13.addItem(oMenuItem133);

        oMenuItem12.setSubmenu(oMenu13);

        oMenu1.addItem(oMenuItem6);
        oMenu1.addItem(oMenuItem7);
        oMenu1.addItem(oMenuItem8);
        oMenu1.addItem(oMenuItem9);
        oMenu1.addItem(oMenuItem10);
        oMenu1.addItem(oMenuItem11);
        oMenu1.addItem(oMenuItem12);

        //----------------------------------------------------------------------

        // Create the items and add them to the menu 2

        var oMenuItem21 = new sap.ui.commons.MenuItem("item2-0-1", {text: "Work Order Management", enabled: false});
        oMenu2.addItem(oMenuItem21);
        var oMenuItem22 = new sap.ui.commons.MenuItem("item2-0-2", {text: "Carrier Station Dashboard", enabled: false});
        oMenu2.addItem(oMenuItem22);
        var oMenuItem23 = new sap.ui.commons.MenuItem("item2-0-3", {
            text: "Assembly Station Dashboard",
            enabled: false
        });
        oMenu2.addItem(oMenuItem23);
        //----------------------- SPC--------------------------------------
        var oMenuItem24 = new sap.ui.commons.MenuItem("item2-0-4", {text: "SPC Dashboard", enabled: false});
        oMenu2.addItem(oMenuItem24);
        var oMenuItem25 = new sap.ui.commons.MenuItem("item2-0-5", {text: "Saved File Charts", enabled: false});
        //oMenu2.addItem(oMenuItem25);
        var oMenuItem26 = new sap.ui.commons.MenuItem("item2-0-6", {text: "SPC History Logs", enabled: false});
        //oMenu2.addItem(oMenuItem26);

        //----------------------------------------------------------------------

        // Create the items and add them to the menu 3

        var oMenuItem31 = new sap.ui.commons.MenuItem("item3-0-1", {text: "Production Status Report", enabled: false});
        oMenu3.addItem(oMenuItem31);
        var oMenuItem32 = new sap.ui.commons.MenuItem("item3-0-2", {text: "Item Traceability Report", enabled: false});
        oMenu3.addItem(oMenuItem32);
        var oMenuItem33 = new sap.ui.commons.MenuItem("item3-0-3", {text: "Connector Diagnostics", enabled: false});
        oMenu3.addItem(oMenuItem33);
        //----------------------- SPC--------------------------------------
        var oMenuItem34 = new sap.ui.commons.MenuItem("item3-0-4", {text: "Daily Activity", enabled: false});
        oMenu3.addItem(oMenuItem34);
        var oMenuItem35 = new sap.ui.commons.MenuItem("item3-0-5", {text: "Weekly Activity", enabled: false});
        oMenu3.addItem(oMenuItem35);
        var oMenuItem36 = new sap.ui.commons.MenuItem("item3-0-6", {text: "Monthly Activity", enabled: false});
        oMenu3.addItem(oMenuItem36);

        // ******************************************************************************************************************************************************************

        //Attach the Menu to the MenuButton
        oMenuButton1.setMenu(oMenu1);
        oMenuButton2.setMenu(oMenu2);
        oMenuButton3.setMenu(oMenu3);

        // ******************************************************************************************************************************************************************

        //Attach an event to raise an alert when an item is selected (Button 1)

        oMenuButton1.attachItemSelected(function (oEvent) {

            //	alert( oEvent.getParameter("itemId"));

            switch (oEvent.getParameter("itemId")) {

                // SubMenu Settings 4

                case "item1-4-1":
                    setTimeout("location.href = '" + "MgtHierarchy.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-4-2":
                    setTimeout("location.href = '" + "LvlHierarchy.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;

                // SubMenu Settings 5

                case "item1-5-1":
                    setTimeout("location.href = '" + "MemMapTags.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-5-2":
                    setTimeout("location.href = '" + "MemMapTrxs.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-5-3":
                    setTimeout("location.href = '" + "TagCommGroups.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-5-4":
                    setTimeout("location.href = '" + "TagTypes.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-5-5":
                    setTimeout("location.href = '" + "TagFunctions.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;

                // SubMenu Settings 6

                case "item1-6-1":
                    setTimeout("location.href = '" + "Operators.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-6-2":
                    setTimeout("location.href = '" + "Stations.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-6-3":
                    setTimeout("location.href = '" + "Printers.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-6-4":
                    setTimeout("location.href = '" + "PCoServers.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-6-5":
                    setTimeout("location.href = '" + "PCoAgents.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-6-6":
                    setTimeout("location.href = '" + "SqlServers.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-6-7":
                    setTimeout("location.href = '" + "PCoFileServers.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-6-8":
                    setTimeout("location.href = '" + "PCoFileAgents.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;

                // SubMenu Settings 7

                case "item1-7-1":
                    setTimeout("location.href = '" + "UnitsOfMeasure.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-7-2":
                    setTimeout("location.href = '" + "ProductsMgmt.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-7-3":
                    setTimeout("location.href = '" + "BomMgmt.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-7-4":
                    setTimeout("RoutingMgmt.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;

                // SPC Home

                case "item1-0-6":
                    setTimeout("location.href = '" + spc_href + "SPCM.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;

                // SubMenu Settings 8

                case "item1-8-1":
                    // document.location.href = 'Plants.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "Plants.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-8-2":
                    // document.location.href = 'ImportPlants.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "ImportPlants.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-8-3":
                    // document.location.href = 'ExportPlants.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "ExportPlants.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;

                // SubMenu Settings 9

                case "item1-9-1":
                    // document.location.href = 'Stations.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "Stations.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-9-2":
                    // document.location.href = 'ImportStations.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "ImportStations.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-9-3":
                    // document.location.href = 'ExportStations.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "ExportStations.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;

                // SubMenu Settings 10

                case "item1-10-1":
                    // document.location.href = 'Parts.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "Parts.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-10-2":
                    // document.location.href = 'ImportParts.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "ImportParts.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-10-3":
                    // document.location.href = 'ExportParts.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "ExportParts.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;

                // SubMenu Settings 11

                case "item1-11-1":
                    // document.location.href = 'DatapointsHDR.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "DatapointsHDR.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-11-2":
                    // document.location.href = 'DatapointsSPC.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "DatapointsSPC.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-11-3":
                    // document.location.href = 'ImportDatapoints.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "ImportDatapoints.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-11-4":
                    // document.location.href = 'ExportDatapoints.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "ExportDatapoints.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;

                // SubMenu Settings 12

                case "item1-12-1":
                    // document.location.href = 'Operators.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "Operators.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-12-2":
                    // document.location.href = 'ImportOperators.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "ImportOperators.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-12-3":
                    // document.location.href = 'ExportOperators.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "ExportOperators.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;

                // SubMenu Settings 13

                case "item1-13-1":
                    // document.location.href = 'Subscriptions.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "Subscriptions.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-13-2":
                    // document.location.href = 'ImportSubscriptions.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "ImportSubscriptions.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item1-13-3":
                    // document.location.href = 'ExportSubscriptions.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "ExportSubscriptions.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;

                // Menu Default
                default:
                    // alert("Items \"" + oEvent.getParameter("itemId") + "\" was selected.");
                    break;
            }
        });

        //Attach an event to raise an alert when an item is selected (Button 2)

        oMenuButton2.attachItemSelected(function (oEvent) {
            switch (oEvent.getParameter("itemId")) {
                case "item2-0-1":
                    setTimeout("location.href = '" + "WorkOrders.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item2-0-2":
                    setTimeout("location.href = '" + "CarrierDashboard.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item2-0-3":
                    setTimeout("location.href = '" + "AssemblyDashboard.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item2-0-4":
                    // document.location.href = 'SPCDashboard.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "SPCDashboard.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                default:
                    // alert("Items \"" + oEvent.getParameter("itemId") + "\" was selected.");
                    break;
            }
        });

        //Attach an event to raise an alert when an item is selected. (Button 3)

        oMenuButton3.attachItemSelected(function (oEvent) {
            switch (oEvent.getParameter("itemId")) {
                // Menu Reports
                case "item3-0-1":
                    setTimeout("location.href = '" + "ProductionStatus.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item3-0-2":
                    setTimeout("location.href = '" + "ItemTraceability.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item3-0-3":
                    setTimeout("location.href = '" + "MESM.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item3-0-4":
                    // document.location.href = 'DailyReport.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "DailyReport.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item3-0-5":
                    // document.location.href = 'WeeklyReport.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "WeeklyReport.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                case "item3-0-6":
                    // document.location.href = 'MonthlyReport.irpt?ROLE=' + document.getElementById("user_role").value;
                    setTimeout("location.href = '" + spc_href + "MonthlyReport.irpt?ROLE=" + document.getElementById("user_role").value + "'", 0);
                    break;
                default:
                    //alert("Items \"" + oEvent.getParameter("itemId") + "\" was selected.");
                    break;
            }
        });
        // ****************************************************************************************************************************************************
        var oMatrixT = new sap.ui.commons.layout.MatrixLayout({
            id: 'MatrixT',
            layoutFixed: true,
            width: '1140px',
            columns: 1,
            widths: ['1140px']
        });

        var today = new Date();
        var StartDate = today.yyyymmddWoDash();
        var yesterday = new Date();
        yesterday.setDate(yesterday.getDate() - 1);

        // create DatePicker
        var oDatePicker = new sap.ui.commons.DatePicker('date1');
        oDatePicker.setYyyymmdd(StartDate);
        oDatePicker.setLocale("en-US");
        oDatePicker.attachChange(
            function (oEvent) {
                if (oEvent.getParameter("invalidValue")) {
                    oEvent.oSource.setValueState(sap.ui.core.ValueState.Error);
                } else {
                    oEvent.oSource.setValueState(sap.ui.core.ValueState.None);
                }
            }
        );
        oMatrixT.createRow(oDatePicker);

        // ****************************************************************************************************************************************************
        function updateDates() {
            StartDate = oDatePicker.getYyyymmdd();
        }

        // ******************************************************************************************************************************************************************
        var timer_is_on = 0;
        var timerVar = setInterval(function () {
            return;
            //updateTableConnDiagnostics();
        }, 10000);

        function startTimer() {
            return;
            if (timerVar) {
                clearInterval(timerVar);
                timerVar = setInterval(function () {
                    //updateTableConnDiagnostics();
                }, 10000);
            }
        }

        function stopTimer() {
            clearInterval(timerVar);
            timer_is_on = 0;
        }

        // ******************************************************************************************************************************************************************
        var setIntervalCounter = 60;

        //todo: refresh
        setInterval(function () {
            setIntervalCounter++;
            TICK++;
            // panelOEE(85 + Math.round((Math.random() * 14)), 85 + Math.round((Math.random() * 14)), 85 + Math.round((Math.random() * 14)));  //availability%, performance%, quality%
            if (setIntervalCounter >= 20) {  // 20 * 3 Secs
                setIntervalCounter = 0;
                sqlgetCurrentOEEbyOP(selectedOps);
            }
            simulateTarget();
            chartOeeTrendRefresh();
            chartSixBigLossesRefresh(rtsOEEM.bigLossFilter); // %
            panelSixBigLossesRefresh();
        }, 3000);


        function sqlgetCurrentOEEbyOP(opName) {
            var timestamp = new Date().getTime();
            url = "/XMII/Illuminator?QueryTemplate=MESM/OEEM/QUERIES/sql_getCurrentOEEbyOP&Param.1=" + opName + "&ts=" + timestamp + "&Content-Type=text/xml";
            getData(url, function (_data) {
                panelOEE(Math.floor(_data[0].AVAILABILITY), Math.floor(_data[0].PERFORMANCE), Math.floor(_data[0].QUALITY));  //availability%, performance%, quality%
            });
        }

        function panelSixBigLossesRefresh() {
            var
                c1 = Math.round(10 + (Math.random() * 100)),
                c2 = Math.round(10 + (Math.random() * 100)),
                c3 = Math.round(10 + (Math.random() * 100)),
                c4 = Math.round(10 + (Math.random() * 100)),
                c5 = Math.round(10 + (Math.random() * 100)),
                c6 = Math.round(10 + (Math.random() * 100)),
                t1 = Math.round(Math.random() * 5000),
                t2 = Math.round(Math.random() * 5000),
                t3 = Math.round(Math.random() * 5000),
                t4 = Math.round(Math.random() * 5000),
                t5 = Math.round(Math.random() * 5000),
                t6 = Math.round(Math.random() * 5000),
                t = t1 + t2 + t3 + t4 + t5 + t6;
            sblEquipmentFailure((100 * t1 / t) | 0, c1, t1);       //new rate%, Occurrences, Totalizer(sec)
            sblSetupAndAdjustments((100 * t2 / t) | 0, c2, t2);    //new rate%, Occurrences, Totalizer(sec)
            sblIdlingAndMinorStops((100 * t3 / t) | 0, c3, t3);    //new rate%, Occurrences, Totalizer(sec)
            sblReducedSpeed((100 * t4 / t) | 0, c4, t4);           //new rate%, Occurrences, Totalizer(sec)
            sblProcessDefects((100 * t5 / t) | 0, c5, t5);         //new rate%, Occurrences, Totalizer(sec)
            sblReducedYield((100 * t6 / t) | 0, c6, t6);           //new rate%, Occurrences, Totalizer(sec)
        };

        function chartSixBigLossesRefresh(filter) {
            var chartSeries = [
                rtsOEEM.sblEquipmentFailure.rate[rtsOEEM.sblEquipmentFailure.rate.length - 1],
                rtsOEEM.sblSetupAndAdjustments.rate[rtsOEEM.sblSetupAndAdjustments.rate.length - 1],
                rtsOEEM.sblIdlingAndMinorStops.rate[rtsOEEM.sblIdlingAndMinorStops.rate.length - 1],
                rtsOEEM.sblReducedSpeed.rate[rtsOEEM.sblReducedSpeed.rate.length - 1],
                rtsOEEM.sblProcessDefects.rate[rtsOEEM.sblProcessDefects.rate.length - 1],
                rtsOEEM.sblReducedYield.rate[rtsOEEM.sblReducedYield.rate.length - 1],
            ];

            var chartCategories = [
                rtsOEEM.sblEquipmentFailure.title,
                rtsOEEM.sblSetupAndAdjustments.title,
                rtsOEEM.sblIdlingAndMinorStops.title,
                rtsOEEM.sblReducedSpeed.title,
                rtsOEEM.sblProcessDefects.title,
                rtsOEEM.sblReducedYield.title,
            ];

            for (var i = 0; i < 5; i++) {
                for (var j = i + 1; j < 6; j++) {
                    if (chartSeries[i] < chartSeries[j]) {
                        var t1 = chartSeries[i];
                        chartSeries[i] = chartSeries[j];
                        chartSeries[j] = t1;
                        var t2 = chartCategories[i];
                        chartCategories[i] = chartCategories[j];
                        chartCategories[j] = t2;
                    }
                }
            }
            var chartSeries2 = [];
            var chartSeries3 = [];

            var g = 0;
            for (var n = 0; n < chartSeries.length; n++) {
                g = g + chartSeries[n];
                chartSeries2.push(chartSeries[n]);
                chartSeries3.push(g);
                if (g > filter) {
                    n = 100;
                }
            }

            chartSixBigLosses.series[0].setData(chartSeries2);
            chartSixBigLosses.series[1].setData(chartSeries3);
            chartSixBigLosses.series[2].setData([{
                name: chartCategories[0],
                y: chartSeries[0],
            }, {
                name: chartCategories[1],
                y: chartSeries[1],
            }, {
                name: chartCategories[2],
                y: chartSeries[2],
            }, {
                name: chartCategories[3],
                y: chartSeries[3],
            }, {
                name: chartCategories[4],
                y: chartSeries[4],
            }, {
                name: chartCategories[5],
                y: chartSeries[5],
            }]);
            chartSixBigLosses.xAxis[0].setCategories(chartCategories);
        }

        function panelOEE(availability, performance, quality) {
            rtsOEEM.availability = availability;
            rtsOEEM.performance = performance;
            rtsOEEM.quality = quality;
            document.getElementById('panelOEE').innerHTML = ((availability * performance * quality / 10000) | 0) + "%";
            document.getElementById('panelAvailability').innerHTML = availability + "%";
            document.getElementById('panelPerformance').innerHTML = performance + "%";
            document.getElementById('panelQuality').innerHTML = quality + "%";
        }

        function chartOeeTrendRefresh() {
            var ts = Math.round(new Date().getTime() / 1000) * 1000;
            chartOeeTrend.series[1].addPoint([ts, rtsOEEM.availability], false, false);
            chartOeeTrend.series[2].addPoint([ts, rtsOEEM.performance], false, false);
            chartOeeTrend.series[3].addPoint([ts, rtsOEEM.quality], false, false);
            chartOeeTrend.series[0].addPoint([ts, (rtsOEEM.availability * rtsOEEM.performance * rtsOEEM.quality / 10000) | 0], false, false);
        }

        function simulateTarget() {
            if (TICK == 5) {
                TICK = 0;
                rtsOEEM.downtime = !rtsOEEM.downtime;
                if (rtsOEEM.downtime) {
                    rtsOEEM.downtimeCurrent = new Date().getTime();
                } else {
                    rtsOEEM.downtimeTotal += (new Date().getTime() - rtsOEEM.downtimeCurrent);
                }
            }
        }

        function cc(obj) {
            console.log(obj);
        }
    </script>
</head>

<body onLoad="roleSecurity()">

<input id="user_roles" type="hidden" value="{IllumLoginRoles}" style="display:block;width:1000px;" readonly/>
<input id="user_role" type="hidden" value="{ROLE}" style="display:block;width:1000px;" readonly/>
<input id="user_name" type="hidden" value="{IllumLoginName}" style="display: block;width:1000px;" readonly/>
<input id="user_height" type="hidden" value="{HEIGHT}" style="display: block;width:100px;" readonly/>
<input id="user_address" type="hidden" value="{Machine}" style="display:block;width:1000px;" readonly/>
<input id="station_name" type="hidden" value="{NAME}" style="display: block;width:100px;" readonly/>

<div id="app_header">
    <div id="app_title">OEE DASHBOARD</div>
    <div id="app_menu"></div>
    <div id="page_title">DEFAULT</div>
</div>
<div id="mesm_content"></div>

<div class="container">
    <div class="row">
        <div class="col-md-3">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-xs-3">
                            <i class="fa fa-cogs  fa-5x"></i>
                        </div>
                        <div class="col-xs-9 text-right">
                            <div id="panelOEE" class="huge">%</div>
                            <div>OEE</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="panel panel-cyan">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-xs-3">
                            <i class="fa fa-clock-o fa-5x"></i>
                        </div>
                        <div class="col-xs-9 text-right">
                            <div id="panelAvailability" class="huge">%</div>
                            <div>Availability</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="panel panel-cyan">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-xs-3">
                            <i class="fa fa-wrench fa-5x"></i>
                        </div>
                        <div class="col-xs-9 text-right">
                            <div id="panelPerformance" class="huge">%</div>
                            <div>Performance</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="panel panel-cyan">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-xs-3">
                            <i class="fa fa-check-square-o fa-5x"></i>
                        </div>
                        <div class="col-xs-9 text-right">
                            <div id="panelQuality" class="huge">%</div>
                            <div>Quality</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="panel-group" id="accordion">
        <div class="panel panel-default">
            <div class="panel-heading">
                <a data-toggle="collapse" data-parent="#accordion" href="#collapse4">
                    <i class="fa fa-area-chart"></i>
                    &nbsp; CHARTS &amp; TRENDS
                </a>
            </div>

            <div id="collapse4" class="panel-collapse collapse">
                <div class="panel-body">
                    <div id="myCarousel" class="carousel slide" data-ride="carousel" data-interval="10000">
                        <!-- Indicators -->
                        <ol class="carousel-indicators">
                            <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                            <li data-target="#myCarousel" data-slide-to="1"></li>
                            <li data-target="#myCarousel" data-slide-to="2"></li>
                        </ol>

                        <div class="carousel-inner">

                            <div class="item active">
                                <div class="panel-body">
                                    <div id="chartOeeTrend"></div>
                                </div>
                            </div>

                            <div class="item">
                                <div class="panel-body">
                                    <div id="chartSixBigLosses"></div>
                                </div>
                            </div>

                            <div class="item">
                                <div class="panel-body">
                                    <div class="row">
                                        <div id="chartEvents" class="col-md-7"></div>
                                        <div class="col-md-5">
                                            <div class="panel-body">
                                                <div class="table">
                                                    <table id="eventsTable" class="table table-hover">
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <a class="left carousel-control" href="#myCarousel" data-slide="prev">
                            <span class="glyphicon glyphicon-chevron-left"></span>
                            <span class="sr-only">Previous</span>
                        </a>
                        <a class="right carousel-control" href="#myCarousel" data-slide="next">
                            <span class="glyphicon glyphicon-chevron-right"></span>
                            <span class="sr-only">Next</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="row">
        <div class="col-md-6">
            <div class="panel panel-success">
                <div class="panel-heading">
                    Six Big Losses > Availability Loss > EQUIPMENT FAILURE
                </div>
                <div id="EquipmentFailure" class="panel-body">
                    <div id="chartEquipmentFailure" class="col-sm-4"></div>
                    <ul id="rateEquipmentFailure" class="col-sm-8" style="font-size: 16px">
                        <li></li>
                        <li></li>
                    </ul>
                </div>
                <div class="panel-footer">
                    Reasons for equipment failure include tooling failure, breakdowns, and unplanned
                    maintenance. From the broader perspective of unplanned stops, other common reasons include no
                    operators or
                    materials, being starved by upstream equipment or being blocked by downstream equipment.
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="panel panel-success">
                <div class="panel-heading">
                    Six Big Losses > Availability Loss > SETUP AND ADJUSTMENTS
                </div>
                <div id="SetupAndAdjustments" class="panel-body">
                    <div id="chartSetupAndAdjustments" class="col-sm-4"></div>
                    <ul id="rateSetupAndAdjustments" class="col-sm-8" style="font-size: 16px">
                        <li></li>
                        <li></li>
                    </ul>
                </div>
                <div class="panel-footer">
                    Reasons for Setup and Adjustments include setup, changeovers, major adjustments, and
                    tooling adjustments. From the broader perspective of planned stops, other common reasons include
                    cleaning,
                    warmup time, planned maintenance, and quality inspections.
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6">
            <div class="panel panel-warning">
                <div class="panel-heading">
                    Six Big Losses > Performance Loss > IDLING AND MINOR STOPS
                </div>
                <div id="IdlingAndMinorStops" class="panel-body" style="list-style-type: square">
                    <div id="chartIdlingAndMinorStops" class="col-sm-4"></div>
                    <ul id="rateIdlingAndMinorStops" class="col-sm-8" style="font-size: 16px">
                        <li></li>
                        <li></li>
                    </ul>
                </div>
                <div class="panel-footer">
                    Reasons for Idling and Minor Stops include misfeeds, material jams, obstructed product
                    flow, incorrect settings, misaligned or blocked sensors, equipment design issues, and periodic quick
                    cleaning.
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="panel panel-warning">
                <div class="panel-heading">
                    Six Big Losses > Performance Loss > REDUCED SPEED
                </div>
                <div id="ReducedSpeed" class="panel-body">
                    <div id="chartReducedSpeed" class="col-sm-4"></div>
                    <ul id="rateReducedSpeed" class="col-sm-8" style="font-size: 16px">
                        <li></li>
                        <li></li>
                    </ul>
                </div>
                <div class="panel-footer">
                    Reasons for reduced speed include dirty or worn out equipment, poor lubrication,
                    substandard materials, poor environmental conditions, operator inexperience, startup, and shutdown.
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6">
            <div class="panel panel-info">
                <div class="panel-heading">
                    Six Big Losses > Quality Loss > PROCESS DEFECTS
                </div>
                <div id="ProcessDefects" class="panel-body">
                    <div id="chartProcessDefects" class="col-sm-4"></div>
                    <ul id="rateProcessDefects" class="col-sm-8" style="font-size: 16px">
                        <li></li>
                        <li></li>
                    </ul>
                </div>
                <div class="panel-footer">
                    Reasons for process defects include incorrect equipment settings, operator or equipment
                    handling errors, and lot expiration. This includes scrapped parts as well as parts that can be
                    reworked.
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="panel panel-info">
                <div class="panel-heading">
                    Six Big Losses > Quality Loss > REDUCED YIELD
                </div>
                <div id="ReducedYield" class="panel-body">
                    <div id="chartReducedYield" class="col-sm-4"></div>
                    <ul id="rateReducedYield" class="col-sm-8" style="font-size: 16px">
                        <li></li>
                        <li></li>
                    </ul>
                </div>
                <div class="panel-footer">
                    Reasons for Reduced Yield include suboptimal changeovers, incorrect settings
                    when a new part is run, equipment that needs warmup cycles, or equipment that inherently creates
                    waste after
                    startup.
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
